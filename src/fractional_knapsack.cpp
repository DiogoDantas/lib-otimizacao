#include "../inc/fractional_knapsack.hpp"
#include <algorithm>

// Funcao de comparacao customizada
bool cmp(greedy::Item a, greedy::Item b) {
    double r1 = (double)a.value_ / a.weight_;
    double r2 = (double)b.value_ / b.weight_;
    return r1 > r2;
}

double greedy::fractional_knapsack(int W, std::vector<Item> arr, int n) {

    std::sort(arr.begin(), arr.end(), cmp);

    int curWeight = 0;  // peso atual
    double finalvalue = 0.0; // variavel que armazena o resultado

    // todos os itens
    for (int i = 0; i < n; i++) {
        // adicionando os que cabem
        if (curWeight + arr.at(i).weight_ <= W) {
            curWeight += arr.at(i).weight_;
            finalvalue += arr.at(i).value_;
        } else {
            // adicionando a fração que cabe
            int remain = W - curWeight;
            finalvalue += arr.at(i).value_ * ((double) remain / arr.at(i).weight_);
            break;
        }
    }

    return finalvalue;
}
